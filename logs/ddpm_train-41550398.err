2025-04-24 16:10:09 - INFO: ----- Configuration -----
2025-04-24 16:10:09 - INFO: run_name: DDPM_Conditional_Run1
2025-04-24 16:10:09 - INFO: dataset_path: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cifar10-32
2025-04-24 16:10:09 - INFO: models_dir: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_models
2025-04-24 16:10:09 - INFO: results_dir: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_results
2025-04-24 16:10:09 - INFO: runs_dir: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_runs
2025-04-24 16:10:09 - INFO: save_interval: 5
2025-04-24 16:10:09 - INFO: resume_ckpt: None
2025-04-24 16:10:09 - INFO: image_size: 32
2025-04-24 16:10:09 - INFO: num_classes: 10
2025-04-24 16:10:09 - INFO: c_in: 3
2025-04-24 16:10:09 - INFO: time_dim: 256
2025-04-24 16:10:09 - INFO: noise_steps: 1000
2025-04-24 16:10:09 - INFO: beta_start: 0.0001
2025-04-24 16:10:09 - INFO: beta_end: 0.02
2025-04-24 16:10:09 - INFO: epochs: 10
2025-04-24 16:10:09 - INFO: batch_size: 128
2025-04-24 16:10:09 - INFO: lr: 0.0003
2025-04-24 16:10:09 - INFO: num_workers: 4
2025-04-24 16:10:09 - INFO: force_cpu: False
2025-04-24 16:10:09 - INFO: use_ema: True
2025-04-24 16:10:09 - INFO: ema_beta: 0.995
2025-04-24 16:10:09 - INFO: cfg_drop_prob: 0.1
2025-04-24 16:10:09 - INFO: cfg_scale: 3.0
2025-04-24 16:10:09 - INFO: -------------------------
2025-04-24 16:10:09 - INFO: Created/ Ensured directories exist:
2025-04-24 16:10:09 - INFO:   Models: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_models/DDPM_Conditional_Run1
2025-04-24 16:10:09 - INFO:   Results: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_results/DDPM_Conditional_Run1
2025-04-24 16:10:09 - INFO:   TB Runs: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_runs/DDPM_Conditional_Run1
2025-04-24 16:10:09 - INFO: Using GPU: Tesla V100-SXM2-16GB
2025-04-24 16:10:09 - INFO: Loading/Downloading CIFAR10 dataset to: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cifar10-32
2025-04-24 16:10:11 - INFO: CIFAR10 dataset loaded successfully with 50000 training samples.
/apps/eb/el8/2023a/skylake/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2025-04-24 16:10:11 - INFO: DataLoader created with batch size 128, 4 workers.
2025-04-24 16:10:11 - INFO: Model: UNet_conditional, Num classes: 10
2025-04-24 16:10:11 - INFO: Total Trainable Parameters: 23.34 M
2025-04-24 16:10:11 - INFO: Dataloader length: 391 batches
2025-04-24 16:10:11 - INFO: Using EMA with beta=0.995
2025-04-24 16:10:11 - INFO: Starting training from epoch 1 to 10
2025-04-24 16:10:11 - INFO: --- Starting Epoch 1/10 ---
2025-04-24 16:10:21 - INFO: Epoch 1 Batch [39/391 (10%)]	Step Loss: 0.185635
2025-04-24 16:10:27 - INFO: Epoch 1 Batch [78/391 (20%)]	Step Loss: 0.138414
2025-04-24 16:10:34 - INFO: Epoch 1 Batch [117/391 (30%)]	Step Loss: 0.140349
2025-04-24 16:10:41 - INFO: Epoch 1 Batch [156/391 (40%)]	Step Loss: 0.130558
2025-04-24 16:10:48 - INFO: Epoch 1 Batch [195/391 (50%)]	Step Loss: 0.111790
2025-04-24 16:10:55 - INFO: Epoch 1 Batch [234/391 (60%)]	Step Loss: 0.083673
2025-04-24 16:11:02 - INFO: Epoch 1 Batch [273/391 (70%)]	Step Loss: 0.076872
2025-04-24 16:11:09 - INFO: Epoch 1 Batch [312/391 (80%)]	Step Loss: 0.047304
2025-04-24 16:11:15 - INFO: Epoch 1 Batch [351/391 (90%)]	Step Loss: 0.056523
2025-04-24 16:11:22 - INFO: Epoch 1 Batch [390/391 (100%)]	Step Loss: 0.066575
2025-04-24 16:11:22 - INFO: Epoch 1 Batch [391/391 (100%)]	Step Loss: 0.066537
2025-04-24 16:11:23 - INFO: Epoch 1 Average Loss: 0.1467
2025-04-24 16:11:23 - INFO: --- Starting Epoch 2/10 ---
2025-04-24 16:11:30 - INFO: Epoch 2 Batch [39/391 (10%)]	Step Loss: 0.062254
2025-04-24 16:11:37 - INFO: Epoch 2 Batch [78/391 (20%)]	Step Loss: 0.056517
2025-04-24 16:11:43 - INFO: Epoch 2 Batch [117/391 (30%)]	Step Loss: 0.058031
2025-04-24 16:11:50 - INFO: Epoch 2 Batch [156/391 (40%)]	Step Loss: 0.045831
2025-04-24 16:11:57 - INFO: Epoch 2 Batch [195/391 (50%)]	Step Loss: 0.060025
2025-04-24 16:12:04 - INFO: Epoch 2 Batch [234/391 (60%)]	Step Loss: 0.050898
2025-04-24 16:12:11 - INFO: Epoch 2 Batch [273/391 (70%)]	Step Loss: 0.052406
2025-04-24 16:12:18 - INFO: Epoch 2 Batch [312/391 (80%)]	Step Loss: 0.055327
2025-04-24 16:12:24 - INFO: Epoch 2 Batch [351/391 (90%)]	Step Loss: 0.042301
2025-04-24 16:12:31 - INFO: Epoch 2 Batch [390/391 (100%)]	Step Loss: 0.045031
2025-04-24 16:12:31 - INFO: Epoch 2 Batch [391/391 (100%)]	Step Loss: 0.042379
2025-04-24 16:12:31 - INFO: Epoch 2 Average Loss: 0.0539
2025-04-24 16:12:31 - INFO: --- Starting Epoch 3/10 ---
2025-04-24 16:12:39 - INFO: Epoch 3 Batch [39/391 (10%)]	Step Loss: 0.051051
2025-04-24 16:12:45 - INFO: Epoch 3 Batch [78/391 (20%)]	Step Loss: 0.038268
2025-04-24 16:12:52 - INFO: Epoch 3 Batch [117/391 (30%)]	Step Loss: 0.041752
2025-04-24 16:12:59 - INFO: Epoch 3 Batch [156/391 (40%)]	Step Loss: 0.051287
2025-04-24 16:13:06 - INFO: Epoch 3 Batch [195/391 (50%)]	Step Loss: 0.040083
2025-04-24 16:13:13 - INFO: Epoch 3 Batch [234/391 (60%)]	Step Loss: 0.045027
2025-04-24 16:13:20 - INFO: Epoch 3 Batch [273/391 (70%)]	Step Loss: 0.053337
2025-04-24 16:13:26 - INFO: Epoch 3 Batch [312/391 (80%)]	Step Loss: 0.032556
2025-04-24 16:13:33 - INFO: Epoch 3 Batch [351/391 (90%)]	Step Loss: 0.039108
2025-04-24 16:13:40 - INFO: Epoch 3 Batch [390/391 (100%)]	Step Loss: 0.049167
2025-04-24 16:13:40 - INFO: Epoch 3 Batch [391/391 (100%)]	Step Loss: 0.050950
2025-04-24 16:13:40 - INFO: Epoch 3 Average Loss: 0.0468
2025-04-24 16:13:40 - INFO: --- Starting Epoch 4/10 ---
2025-04-24 16:13:48 - INFO: Epoch 4 Batch [39/391 (10%)]	Step Loss: 0.037622
2025-04-24 16:13:54 - INFO: Epoch 4 Batch [78/391 (20%)]	Step Loss: 0.043313
2025-04-24 16:14:01 - INFO: Epoch 4 Batch [117/391 (30%)]	Step Loss: 0.051081
2025-04-24 16:14:08 - INFO: Epoch 4 Batch [156/391 (40%)]	Step Loss: 0.053186
2025-04-24 16:14:15 - INFO: Epoch 4 Batch [195/391 (50%)]	Step Loss: 0.044997
2025-04-24 16:14:22 - INFO: Epoch 4 Batch [234/391 (60%)]	Step Loss: 0.033800
2025-04-24 16:14:29 - INFO: Epoch 4 Batch [273/391 (70%)]	Step Loss: 0.049242
2025-04-24 16:14:35 - INFO: Epoch 4 Batch [312/391 (80%)]	Step Loss: 0.039524
2025-04-24 16:14:42 - INFO: Epoch 4 Batch [351/391 (90%)]	Step Loss: 0.035853
2025-04-24 16:14:49 - INFO: Epoch 4 Batch [390/391 (100%)]	Step Loss: 0.038178
2025-04-24 16:14:49 - INFO: Epoch 4 Batch [391/391 (100%)]	Step Loss: 0.039183
2025-04-24 16:14:49 - INFO: Epoch 4 Average Loss: 0.0436
2025-04-24 16:14:49 - INFO: --- Starting Epoch 5/10 ---
2025-04-24 16:14:56 - INFO: Epoch 5 Batch [39/391 (10%)]	Step Loss: 0.042038
2025-04-24 16:15:03 - INFO: Epoch 5 Batch [78/391 (20%)]	Step Loss: 0.039679
2025-04-24 16:15:10 - INFO: Epoch 5 Batch [117/391 (30%)]	Step Loss: 0.032642
2025-04-24 16:15:17 - INFO: Epoch 5 Batch [156/391 (40%)]	Step Loss: 0.038995
2025-04-24 16:15:24 - INFO: Epoch 5 Batch [195/391 (50%)]	Step Loss: 0.042919
2025-04-24 16:15:31 - INFO: Epoch 5 Batch [234/391 (60%)]	Step Loss: 0.040360
2025-04-24 16:15:37 - INFO: Epoch 5 Batch [273/391 (70%)]	Step Loss: 0.040711
2025-04-24 16:15:44 - INFO: Epoch 5 Batch [312/391 (80%)]	Step Loss: 0.036457
2025-04-24 16:15:51 - INFO: Epoch 5 Batch [351/391 (90%)]	Step Loss: 0.036960
2025-04-24 16:15:58 - INFO: Epoch 5 Batch [390/391 (100%)]	Step Loss: 0.029426
2025-04-24 16:15:58 - INFO: Epoch 5 Batch [391/391 (100%)]	Step Loss: 0.042763
2025-04-24 16:15:58 - INFO: Epoch 5 Average Loss: 0.0416
2025-04-24 16:15:58 - INFO: Epoch 5: Sampling images and saving checkpoints...
2025-04-24 16:15:58 - INFO: Sampling from standard model...
2025-04-24 16:16:15 - INFO: Saved standard model samples to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_results/DDPM_Conditional_Run1/5.jpg
2025-04-24 16:16:15 - INFO: Sampling from EMA model...
2025-04-24 16:16:32 - INFO: Saved EMA model samples to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_results/DDPM_Conditional_Run1/5_ema.jpg
2025-04-24 16:16:33 - INFO: Saved checkpoint to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_models/DDPM_Conditional_Run1/ckpt_epoch_5.pt
2025-04-24 16:16:33 - INFO: Saved EMA checkpoint to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_models/DDPM_Conditional_Run1/ema_ckpt_epoch_5.pt
2025-04-24 16:16:33 - INFO: --- Starting Epoch 6/10 ---
2025-04-24 16:16:40 - INFO: Epoch 6 Batch [39/391 (10%)]	Step Loss: 0.045321
2025-04-24 16:16:47 - INFO: Epoch 6 Batch [78/391 (20%)]	Step Loss: 0.050854
2025-04-24 16:16:54 - INFO: Epoch 6 Batch [117/391 (30%)]	Step Loss: 0.039379
2025-04-24 16:17:01 - INFO: Epoch 6 Batch [156/391 (40%)]	Step Loss: 0.032601
2025-04-24 16:17:08 - INFO: Epoch 6 Batch [195/391 (50%)]	Step Loss: 0.045698
2025-04-24 16:17:15 - INFO: Epoch 6 Batch [234/391 (60%)]	Step Loss: 0.033249
2025-04-24 16:17:21 - INFO: Epoch 6 Batch [273/391 (70%)]	Step Loss: 0.033955
2025-04-24 16:17:28 - INFO: Epoch 6 Batch [312/391 (80%)]	Step Loss: 0.037167
2025-04-24 16:17:35 - INFO: Epoch 6 Batch [351/391 (90%)]	Step Loss: 0.037678
2025-04-24 16:17:42 - INFO: Epoch 6 Batch [390/391 (100%)]	Step Loss: 0.037858
2025-04-24 16:17:42 - INFO: Epoch 6 Batch [391/391 (100%)]	Step Loss: 0.041545
2025-04-24 16:17:42 - INFO: Epoch 6 Average Loss: 0.0399
2025-04-24 16:17:42 - INFO: --- Starting Epoch 7/10 ---
2025-04-24 16:17:49 - INFO: Epoch 7 Batch [39/391 (10%)]	Step Loss: 0.030539
2025-04-24 16:17:56 - INFO: Epoch 7 Batch [78/391 (20%)]	Step Loss: 0.036124
2025-04-24 16:18:03 - INFO: Epoch 7 Batch [117/391 (30%)]	Step Loss: 0.033795
2025-04-24 16:18:10 - INFO: Epoch 7 Batch [156/391 (40%)]	Step Loss: 0.032492
2025-04-24 16:18:17 - INFO: Epoch 7 Batch [195/391 (50%)]	Step Loss: 0.033483
2025-04-24 16:18:24 - INFO: Epoch 7 Batch [234/391 (60%)]	Step Loss: 0.036311
2025-04-24 16:18:31 - INFO: Epoch 7 Batch [273/391 (70%)]	Step Loss: 0.055569
2025-04-24 16:18:38 - INFO: Epoch 7 Batch [312/391 (80%)]	Step Loss: 0.038682
2025-04-24 16:18:45 - INFO: Epoch 7 Batch [351/391 (90%)]	Step Loss: 0.066234
2025-04-24 16:18:51 - INFO: Epoch 7 Batch [390/391 (100%)]	Step Loss: 0.035430
2025-04-24 16:18:52 - INFO: Epoch 7 Batch [391/391 (100%)]	Step Loss: 0.045640
2025-04-24 16:18:52 - INFO: Epoch 7 Average Loss: 0.0386
2025-04-24 16:18:52 - INFO: --- Starting Epoch 8/10 ---
2025-04-24 16:18:59 - INFO: Epoch 8 Batch [39/391 (10%)]	Step Loss: 0.035122
2025-04-24 16:19:06 - INFO: Epoch 8 Batch [78/391 (20%)]	Step Loss: 0.043883
2025-04-24 16:19:13 - INFO: Epoch 8 Batch [117/391 (30%)]	Step Loss: 0.046167
2025-04-24 16:19:19 - INFO: Epoch 8 Batch [156/391 (40%)]	Step Loss: 0.042409
2025-04-24 16:19:26 - INFO: Epoch 8 Batch [195/391 (50%)]	Step Loss: 0.034721
2025-04-24 16:19:33 - INFO: Epoch 8 Batch [234/391 (60%)]	Step Loss: 0.053610
2025-04-24 16:19:40 - INFO: Epoch 8 Batch [273/391 (70%)]	Step Loss: 0.027657
2025-04-24 16:19:47 - INFO: Epoch 8 Batch [312/391 (80%)]	Step Loss: 0.032662
2025-04-24 16:19:54 - INFO: Epoch 8 Batch [351/391 (90%)]	Step Loss: 0.035538
2025-04-24 16:20:01 - INFO: Epoch 8 Batch [390/391 (100%)]	Step Loss: 0.039158
2025-04-24 16:20:01 - INFO: Epoch 8 Batch [391/391 (100%)]	Step Loss: 0.037059
2025-04-24 16:20:01 - INFO: Epoch 8 Average Loss: 0.0368
2025-04-24 16:20:01 - INFO: --- Starting Epoch 9/10 ---
2025-04-24 16:20:08 - INFO: Epoch 9 Batch [39/391 (10%)]	Step Loss: 0.035572
2025-04-24 16:20:15 - INFO: Epoch 9 Batch [78/391 (20%)]	Step Loss: 0.038582
2025-04-24 16:20:22 - INFO: Epoch 9 Batch [117/391 (30%)]	Step Loss: 0.033668
2025-04-24 16:20:29 - INFO: Epoch 9 Batch [156/391 (40%)]	Step Loss: 0.033074
2025-04-24 16:20:36 - INFO: Epoch 9 Batch [195/391 (50%)]	Step Loss: 0.027767
2025-04-24 16:20:43 - INFO: Epoch 9 Batch [234/391 (60%)]	Step Loss: 0.030176
2025-04-24 16:20:50 - INFO: Epoch 9 Batch [273/391 (70%)]	Step Loss: 0.033760
2025-04-24 16:20:56 - INFO: Epoch 9 Batch [312/391 (80%)]	Step Loss: 0.038021
2025-04-24 16:21:03 - INFO: Epoch 9 Batch [351/391 (90%)]	Step Loss: 0.036456
2025-04-24 16:21:10 - INFO: Epoch 9 Batch [390/391 (100%)]	Step Loss: 0.039375
2025-04-24 16:21:10 - INFO: Epoch 9 Batch [391/391 (100%)]	Step Loss: 0.022149
2025-04-24 16:21:10 - INFO: Epoch 9 Average Loss: 0.0367
2025-04-24 16:21:10 - INFO: --- Starting Epoch 10/10 ---
2025-04-24 16:21:18 - INFO: Epoch 10 Batch [39/391 (10%)]	Step Loss: 0.033836
2025-04-24 16:21:24 - INFO: Epoch 10 Batch [78/391 (20%)]	Step Loss: 0.034179
2025-04-24 16:21:31 - INFO: Epoch 10 Batch [117/391 (30%)]	Step Loss: 0.035174
2025-04-24 16:21:38 - INFO: Epoch 10 Batch [156/391 (40%)]	Step Loss: 0.031942
2025-04-24 16:21:45 - INFO: Epoch 10 Batch [195/391 (50%)]	Step Loss: 0.029795
2025-04-24 16:21:52 - INFO: Epoch 10 Batch [234/391 (60%)]	Step Loss: 0.032627
2025-04-24 16:21:59 - INFO: Epoch 10 Batch [273/391 (70%)]	Step Loss: 0.034202
2025-04-24 16:22:06 - INFO: Epoch 10 Batch [312/391 (80%)]	Step Loss: 0.037130
2025-04-24 16:22:13 - INFO: Epoch 10 Batch [351/391 (90%)]	Step Loss: 0.038503
2025-04-24 16:22:20 - INFO: Epoch 10 Batch [390/391 (100%)]	Step Loss: 0.031695
2025-04-24 16:22:20 - INFO: Epoch 10 Batch [391/391 (100%)]	Step Loss: 0.028228
2025-04-24 16:22:20 - INFO: Epoch 10 Average Loss: 0.0367
2025-04-24 16:22:20 - INFO: Epoch 10: Sampling images and saving checkpoints...
2025-04-24 16:22:20 - INFO: Sampling from standard model...
2025-04-24 16:22:37 - INFO: Saved standard model samples to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_results/DDPM_Conditional_Run1/10.jpg
2025-04-24 16:22:37 - INFO: Sampling from EMA model...
2025-04-24 16:22:54 - INFO: Saved EMA model samples to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_results/DDPM_Conditional_Run1/10_ema.jpg
2025-04-24 16:22:54 - INFO: Saved checkpoint to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_models/DDPM_Conditional_Run1/ckpt_epoch_10.pt
2025-04-24 16:22:55 - INFO: Saved EMA checkpoint to /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cluster_models/DDPM_Conditional_Run1/ema_ckpt_epoch_10.pt
2025-04-24 16:22:55 - INFO: --- Training Finished ---
