2025-04-24 15:52:50 - INFO: ----- Configuration -----
2025-04-24 15:52:50 - INFO: run_name: DDPM_Conditional_Run1
2025-04-24 15:52:50 - INFO: dataset_path: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cifar10-32
2025-04-24 15:52:50 - INFO: models_dir: DATA_DIR/cluster_models
2025-04-24 15:52:50 - INFO: results_dir: DATA_DIR/cluster_results
2025-04-24 15:52:50 - INFO: runs_dir: DATA_DIR/cluster_runs
2025-04-24 15:52:50 - INFO: save_interval: 5
2025-04-24 15:52:50 - INFO: resume_ckpt: None
2025-04-24 15:52:50 - INFO: image_size: 32
2025-04-24 15:52:50 - INFO: num_classes: 10
2025-04-24 15:52:50 - INFO: c_in: 3
2025-04-24 15:52:50 - INFO: time_dim: 256
2025-04-24 15:52:50 - INFO: noise_steps: 1000
2025-04-24 15:52:50 - INFO: beta_start: 0.0001
2025-04-24 15:52:50 - INFO: beta_end: 0.02
2025-04-24 15:52:50 - INFO: epochs: 1
2025-04-24 15:52:50 - INFO: batch_size: 32
2025-04-24 15:52:50 - INFO: lr: 0.0003
2025-04-24 15:52:50 - INFO: num_workers: 4
2025-04-24 15:52:50 - INFO: force_cpu: False
2025-04-24 15:52:50 - INFO: use_ema: True
2025-04-24 15:52:50 - INFO: ema_beta: 0.995
2025-04-24 15:52:50 - INFO: cfg_drop_prob: 0.1
2025-04-24 15:52:50 - INFO: cfg_scale: 3.0
2025-04-24 15:52:50 - INFO: -------------------------
2025-04-24 15:52:50 - INFO: Created/ Ensured directories exist:
2025-04-24 15:52:50 - INFO:   Models: DATA_DIR/cluster_models/DDPM_Conditional_Run1
2025-04-24 15:52:50 - INFO:   Results: DATA_DIR/cluster_results/DDPM_Conditional_Run1
2025-04-24 15:52:50 - INFO:   TB Runs: DATA_DIR/cluster_runs/DDPM_Conditional_Run1
2025-04-24 15:52:50 - INFO: Using GPU: Tesla V100-SXM2-16GB
2025-04-24 15:52:50 - INFO: Loading/Downloading CIFAR10 dataset to: /well/nichols-nvs/users/peo100/diffusion/Diffusion-Models-pytorch/cifar10-32
  0%|          | 0/170498071 [00:00<?, ?it/s]  0%|          | 65536/170498071 [00:00<08:02, 353405.26it/s]  0%|          | 229376/170498071 [00:00<04:18, 658096.81it/s]  0%|          | 819200/170498071 [00:00<01:14, 2279537.29it/s]  1%|          | 1769472/170498071 [00:00<00:41, 4105670.38it/s]  2%|▏         | 3735552/170498071 [00:00<00:22, 7507972.61it/s]  4%|▍         | 7438336/170498071 [00:00<00:10, 15124652.96it/s]  6%|▋         | 10813440/170498071 [00:00<00:07, 20162824.76it/s]  8%|▊         | 14155776/170498071 [00:01<00:06, 23841528.11it/s] 10%|█         | 17530880/170498071 [00:01<00:05, 26640682.32it/s] 12%|█▏        | 20873216/170498071 [00:01<00:05, 28592010.55it/s] 14%|█▍        | 24215552/170498071 [00:01<00:04, 29982034.50it/s] 16%|█▌        | 27557888/170498071 [00:01<00:04, 30981878.27it/s] 18%|█▊        | 30867456/170498071 [00:01<00:04, 31591284.16it/s] 20%|█▉        | 34078720/170498071 [00:01<00:04, 31706280.38it/s] 22%|██▏       | 37552128/170498071 [00:01<00:04, 32555271.59it/s] 24%|██▍       | 40861696/170498071 [00:01<00:03, 32431967.65it/s] 26%|██▌       | 44171264/170498071 [00:01<00:03, 32618850.30it/s] 28%|██▊       | 47480832/170498071 [00:02<00:03, 32758919.40it/s] 30%|██▉       | 50823168/170498071 [00:02<00:03, 32955061.98it/s] 32%|███▏      | 54132736/170498071 [00:02<00:03, 32990605.84it/s] 34%|███▎      | 57442304/170498071 [00:02<00:03, 33001640.76it/s] 36%|███▌      | 60817408/170498071 [00:02<00:03, 33207300.01it/s] 38%|███▊      | 64192512/170498071 [00:02<00:03, 33343577.49it/s] 40%|███▉      | 67534848/170498071 [00:02<00:03, 33225670.69it/s] 42%|████▏     | 70877184/170498071 [00:02<00:02, 33252664.15it/s] 44%|████▎     | 74219520/170498071 [00:02<00:02, 32973477.70it/s] 45%|████▌     | 77529088/170498071 [00:03<00:03, 27747164.80it/s] 47%|████▋     | 80904192/170498071 [00:03<00:03, 29299661.87it/s] 49%|████▉     | 84213760/170498071 [00:03<00:02, 30327484.90it/s] 51%|█████▏    | 87556096/170498071 [00:03<00:02, 31183408.14it/s] 53%|█████▎    | 90865664/170498071 [00:03<00:02, 31723915.40it/s] 55%|█████▌    | 94208000/170498071 [00:03<00:02, 32189664.31it/s] 57%|█████▋    | 97550336/170498071 [00:03<00:02, 32522575.92it/s] 59%|█████▉    | 100859904/170498071 [00:03<00:02, 32624958.95it/s] 61%|██████    | 104169472/170498071 [00:03<00:02, 32623928.89it/s] 63%|██████▎   | 107577344/170498071 [00:03<00:01, 33052285.94it/s] 65%|██████▌   | 110919680/170498071 [00:04<00:01, 32781583.54it/s] 67%|██████▋   | 114229248/170498071 [00:04<00:01, 32556808.82it/s] 69%|██████▉   | 117506048/170498071 [00:04<00:01, 32458532.06it/s] 71%|███████   | 121077760/170498071 [00:04<00:01, 33413661.81it/s] 73%|███████▎  | 124452864/170498071 [00:04<00:01, 33461465.34it/s] 75%|███████▍  | 127827968/170498071 [00:04<00:01, 33477875.48it/s] 77%|███████▋  | 131203072/170498071 [00:04<00:01, 33467845.24it/s] 79%|███████▉  | 134610944/170498071 [00:04<00:01, 33642006.01it/s] 81%|████████  | 137986048/170498071 [00:04<00:00, 33611562.17it/s] 83%|████████▎ | 141361152/170498071 [00:05<00:01, 28047374.24it/s] 85%|████████▍ | 144605184/170498071 [00:05<00:00, 29072011.03it/s] 87%|████████▋ | 148176896/170498071 [00:05<00:00, 30876774.39it/s] 89%|████████▉ | 151519232/170498071 [00:05<00:00, 31586374.99it/s] 91%|█████████ | 154861568/170498071 [00:05<00:00, 32106657.47it/s] 93%|█████████▎| 158203904/170498071 [00:05<00:00, 32487727.56it/s] 95%|█████████▍| 161513472/170498071 [00:05<00:00, 32658924.13it/s] 97%|█████████▋| 164823040/170498071 [00:05<00:00, 32761173.36it/s] 99%|█████████▊| 168165376/170498071 [00:05<00:00, 32957241.15it/s]100%|██████████| 170498071/170498071 [00:05<00:00, 28842301.00it/s]
2025-04-24 15:52:59 - INFO: CIFAR10 dataset loaded successfully with 50000 training samples.
/apps/eb/el8/2023a/skylake/software/PyTorch/2.1.2-foss-2023a-CUDA-12.1.1/lib/python3.11/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2025-04-24 15:52:59 - INFO: DataLoader created with batch size 32, 4 workers.
2025-04-24 15:53:00 - INFO: Model: UNet_conditional, Num classes: 10
2025-04-24 15:53:00 - INFO: Total Trainable Parameters: 23.34 M
2025-04-24 15:53:00 - INFO: Dataloader length: 1563 batches
2025-04-24 15:53:00 - INFO: Using EMA with beta=0.995
2025-04-24 15:53:00 - INFO: Starting training from epoch 1 to 1
2025-04-24 15:53:00 - INFO: --- Starting Epoch 1/1 ---
2025-04-24 15:54:31 - INFO: Epoch 1 Average Loss: 0.0728
2025-04-24 15:54:31 - INFO: Epoch 1: Sampling images and saving checkpoints...
2025-04-24 15:54:31 - INFO: Sampling from standard model...
2025-04-24 15:54:48 - INFO: Saved standard model samples to DATA_DIR/cluster_results/DDPM_Conditional_Run1/1.jpg
2025-04-24 15:54:48 - INFO: Sampling from EMA model...
2025-04-24 15:55:06 - INFO: Saved EMA model samples to DATA_DIR/cluster_results/DDPM_Conditional_Run1/1_ema.jpg
2025-04-24 15:55:06 - INFO: Saved checkpoint to DATA_DIR/cluster_models/DDPM_Conditional_Run1/ckpt_epoch_1.pt
2025-04-24 15:55:06 - INFO: Saved EMA checkpoint to DATA_DIR/cluster_models/DDPM_Conditional_Run1/ema_ckpt_epoch_1.pt
2025-04-24 15:55:06 - INFO: --- Training Finished ---
